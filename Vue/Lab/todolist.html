<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue待辦事項</title>
    <!-- 載入reset CSS -->
    <link rel="stylesheet" href="/utility-css/reset.css">
    <!-- 載入Bootstrap 5.0 CSS-->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
    <style>
       
    </style>
</head>

<body>

    <header >
        <figure class="text-center">
            <blockquote class="blockquote">
                <p>待辦事項 Vue2</p>
            </blockquote>
            <figcaption class="blockquote-footer">
                我的待辦清單<cite title="Source Title">TodoList</cite>
            </figcaption>
        </figure>
    </header>

    <div id="app">

        <div class="header ">
            <div class=" input-group mb-3">
                
                <input type="text" id="task" class="form-control " placeholder="請輸入待辦事項" v-model="text">
                <button type="button" class="btn btn-outline-secondary" @click="addTask">新增</button>
            </div>

       
            <div class="main input-group mb-3" v-for="(element, index) in data" :key="index">
                <div class="todolist form-control">
                    <input type="checkbox" class="form-check-input" :id="'done' + index" @click="done(index)"
                        :checked="element.isDone">
                    <input type="text" class="form-control" v-model="element.task" :disabled="!element.isEditing">
                    <button class="btn btn-outline-secondary" :id="'save' + index" @click="save(index,element.task)"
                        v-if=" element.isEditing">完成</button>
                    <button class="btn btn-outline-secondary" :id="'edit' + index" @click="edit(index)"
                        v-if=" !element.isEditing">編輯</button>

                    <button class="btn btn-outline-secondary" :id="'del' + index" @click="del(index)"
                        v-if="!element.isEditing">刪除</button>
                </div>
            </div>
        </div>
    </div>
    <!-- 載入Bootstrap 5.0 Bundle-->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script>

        const app = new Vue({
            el: '#app',
            data: {
                text: '',
                data: [],
                obj: {},
                localStoragekey: 'todolistVue'





            }, methods: {
                addTask() {

                    if (this.text == null || this.text == '') {
                        alert("請輸入待辦事項")
                        return;
                    }
                    this.readLocalStorage();

                    this.obj = {
                        isDone: false,
                        task: this.text,
                        isEditing: false
                    }

                    

                    this.data.push(this.obj)
                    
                    console.log("rendarData0")

                    this.addLocalStorage();
                    this.text = '';
                },
                addLocalStorage() {
                    localStorage.setItem(this.localStoragekey, JSON.stringify(this.data))
                    console.log("rendarData1")
                    this.readLocalStorage();

                },
                readLocalStorage() {
                    this.data = (JSON.parse(localStorage.getItem(this.localStoragekey)));
                    this.data = (this.data == null) ? [] : this.data;
                    console.log(this.data);
                },


                edit(index) {
                    this.data[index].isEditing = true;
                    this.addLocalStorage();
                },

                save(index, task) {
                    this.data[index].task = task;
                    this.data[index].isEditing = false;
                    this.addLocalStorage();
                },
                done(index) {

                    this.data[index].isDone = !this.data[index].isDone;
                    this.addLocalStorage();
                },
                del(index) {
                    console.log(this.dataNum)
                    //this.data.splice(index,1)
                    this.data.splice(index, 1);
                    this.addLocalStorage()


                }
            },
            mounted() {
                this.readLocalStorage();
            }

        })


    </script>
</body>

</html>