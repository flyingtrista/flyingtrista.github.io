<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vue待辦事項</title>
    <script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
</head>

<body>
  


    <div id="app">

        <div class="add">
            <label for="task">新增待辦事項</label>
            <input type="text" id="task" v-model="text"> <button type="button" @click="addTask">新增</button>
        </div>



 

        <div v-for="(element, index) in data" :key="index">
            <div class="todolist">
              <input type="checkbox" :id="'done' + index" @click="done(index)" :checked="element.isDone">
              <input type="text" v-model="element.task" :disabled="!element.isEditing">
              <button :id="'save' + index" @click="save(index,element.task)" v-if=" element.isEditing">完成</button>
              <button :id="'edit' + index" @click="edit(index)" v-if=" !element.isEditing">編輯</button>
             
              <button :id="'del' + index" @click="del(index)" v-if="!element.isEditing" >刪除</button>
            </div>
          </div>
    </div>
    <script>

        const app = new Vue({
            el: '#app',
            data: {
                text: '',
                data: [],
                obj: {},
                localStoragekey: 'todolistVue'
              
               



            }, methods: {
                addTask() {

                    if (this.text == null || this.text == '') {
                        alert("請輸入待辦事項")
                        return;
                    }
                    this.readLocalStorage();

                    this.obj = {
                        isDone: false,
                        task: this.text,
                        isEditing:false
                    }

                    // this.data.push(this.obj);

                    this.data.push(this.obj)
                    // Vue.set(this.data, this.data.length, this.obj);
                    console.log("rendarData0")

                    this.addLocalStorage();
                },
                addLocalStorage() {
                    localStorage.setItem(this.localStoragekey, JSON.stringify(this.data))
                    console.log("rendarData1")
                    this.readLocalStorage();

                },
                readLocalStorage() {
                    this.data = (JSON.parse(localStorage.getItem(this.localStoragekey)));
                    this.data = (this.data == null) ? [] : this.data;
                    console.log(this.data);
                },
             

                edit(index) {
                    this.data[index].isEditing=true;
                    this.addLocalStorage();
                },
                
                save(index,task) {
                    this.data[index].task=task;
                    this.data[index].isEditing=false;
                    this.addLocalStorage();
                },
                done(index) {

                    this.data[index].isDone=!this.data[index].isDone;
                    this.addLocalStorage();
                },
                del(index) {
                console.log(this.dataNum)
                //this.data.splice(index,1)
                this.data.splice(index, 1);
                this.addLocalStorage()
               

        }
            },
            mounted() {
                this.readLocalStorage();
            }

        })


    </script>
</body>

</html>